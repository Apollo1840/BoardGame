<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8"/>
    <title>卡牌生成器</title>
    <style>
        /* 打印保真 */
        img, .content-box, .card-title { print-color-adjust: exact; }
        body { font-family: sans-serif; background: #f0f0f0; padding: 20px; }
        #card-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(63mm,1fr)); gap:10px; justify-items:left; align-items:start; justify-content:start; align-content:start; }

        /* 卡牌基座 */
        .card {
            position: relative;
            width: 63mm;
            height: 88mm;
            border: 2px solid #000;
            border-radius: 8px;
            overflow: hidden;
            page-break-inside: avoid;
            -webkit-print-color-adjust: exact;   /* 旧版 Chromium、Safari */
            print-color-adjust: exact;           /* 新标准写法 */
        }

        /* 分类底色 */
        .card.monster  { background:#ffffff; }   /* 纯白色 */
        .card.prophecy {
            position: relative;
            background: none;
        }
        .card.prophecy::before {
            content: '';
            position: absolute;
            inset: 0;
            z-index: 0;
            background-image: var(--prophecy-bg, none);
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            filter: blur(12px) brightness(0.7) saturate(1.2);
            border-radius: 8px;
            transition: background-image 0.3s;
        }
        .card.prophecy .card-image-container {
            position: absolute;
            top: 24px;
            left: 4px;
            right: 4px;
            bottom: calc(4px + 29.33mm);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2;
            overflow: hidden;
        }
        .card.prophecy .card-content {
            position: absolute;
            bottom: calc(4px + 16px);
            left: 4px;
            right: 4px;
            height: calc(50% - 4px - 16px);
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            gap: 2px;
            overflow: hidden;
            z-index: 3;
            font-size: 10px;
        }
        .card.prophecy .card-title {
            position: absolute;
            top: 4px;
            left: 4px;
            right: 4px;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(10,30,80,0.5) !important;
            border-radius: 4px;
            padding: 2px 4px;
            font-weight: bold;
            font-size: 12px;
            z-index: 3;
            color: #fff !important;
        }

        /* 预言卡文本框深蓝半透明底白字 */
        .card.prophecy .content-box {
            background: rgba(10,30,80,0.5) !important;
            color: #fff !important;
            border-color: rgba(255,255,255,0.2) !important;
        }
        .card.prophecy .box-title,
        .card.prophecy .box-content {
            color: #fff !important;
        }
        /* 响应效果标题依然为红色 */
        .card.prophecy .responsive-effect .box-title {
            color: red !important;
        }
        .card.prophecy .card-title {
            background: rgba(10,30,80,0.5) !important;
            color: #fff !important;
        }

        /* 标题栏 */
        .card-title { position:absolute; top:4px; left:4px; right:4px; display:flex; justify-content:space-between; align-items:center;
            background:rgba(255,255,255,0.9); border-radius:4px; padding:2px 4px; font-weight:bold; font-size:12px; z-index:3; }
        .card-title .level, .card-title .type { font-size:11px; width:15%; text-align:center; }
        .card-title .name { font-size:12px; flex:1; text-align:center; }
        .prophecy .card-title { justify-content:center; }

        /* 图片区 */
        .card-image-container { position:absolute; top:24px; left:4px; right:4px; bottom:calc(4px + 29.33mm);
            display:flex; align-items:center; justify-content:center; z-index:1; overflow:hidden; }
        .card-image-container img { max-width:100%; max-height:100%; object-fit:contain; display:block; }

        /* 文本区 */
        .card-content { position:absolute; bottom:calc(4px + 16px); left:4px; right:4px;
            height:calc(50% - 4px - 16px); display:flex; flex-direction:column; justify-content:flex-end;
            gap:2px; overflow:hidden; z-index:2; font-size:10px; }

        /* 文本框 */
        .content-box{
            background: rgba(255,255,255,0.75);
            border: 3px solid rgba(0,0,0,0.2);
            border-radius: 4px;
            padding: 3px;
            display: grid;
            grid-template-columns: auto 1fr;
            align-items: start;
            overflow: hidden;
        }
        .content-box.attribute-box { border:none; }
        .box-title { font-weight:bold; font-size:10px; margin-right:3px; white-space:nowrap; }
        .box-content { font-size:9px; line-height:1.2; text-align:justify; overflow:hidden; }

        /* 技能框 */
        .skill-box { display:grid; grid-template-columns: auto 1fr; grid-auto-rows: auto; gap:4px; }
        .skill-name { font-weight:bold; font-size:10px; }
        .skill-desc { font-size:9px; }
        .skill-power { display:flex; flex-wrap:wrap; gap:2px; }
        .power-icon::before { content:'✦'; font-size:10px; margin-right:1px; }

        /* 底部数值 */
        .monster .stats { position:absolute; bottom:4px; left:4px; right:4px; display:flex; justify-content:space-between;
            font-size:10px; background:rgba(255,255,255,0.9); padding:1px 4px; border-radius:4px; z-index:4; }
        .stats .atk::before { content:'▲'; margin-right:2px; }
        .stats .def::before { content:'◇'; margin-right:2px; }

        /* 红色标题：响应效果 & 反应属性 */

        .responsive-effect .box-title { color: red; }
        .reaction-attr .box-title { color: red; }
        .normal-attr .box-title { color: blue; }

        @page {               /* 新增 */
            margin: 0;        /* 0 mm 页边距 */
            size: auto;       /* 让浏览器保持原纸张大小 */
        }

        @media print {
            body{background:none;margin:0;padding:0;}
            #main-content {
                width: calc(3 * 63mm + 2 * 2px) !important; /* 3 columns, 2 gaps */
                margin: 0 auto !important;
                box-sizing: border-box !important;
            }
            #card-container{
                display: grid !important;
                grid-template-columns: repeat(3, 63mm) !important;
                gap: 2px !important;
                box-sizing: border-box !important;
                overflow: visible !important;
            }
            .card{box-sizing: border-box !important; box-shadow:none;}
            .card.monster  { background:#ffffff !important; }
            .card.prophecy { background:#e9f1fb !important; }
        }

        /* English mode: smaller attribute text */
        body.en-mode .attribute-box .box-content {
            font-size: 8px !important;
        }
        /* English mode: smaller skill text if 3+ skills */
        body.en-mode .card.monster .content-box.skill-small .skill-desc {
            font-size: 8px !important;
        }

        #lang-switch span {
          user-select: none;
          border: 1px solid #3b82f6;
          margin: 0;
        }
        #lang-switch .active {
          background: #3b82f6 !important;
          color: #fff !important;
        }
        #lang-switch span:not(.active) {
          background: #23272f !important;
          color: #fff !important;
        }

        /* Sidebar styles */
        #sidebar-panel {
          border-top-right-radius: 0 !important;
          border-bottom-right-radius: 0 !important;
          border-radius: 0 !important;
          box-shadow: 2px 0 12px rgba(0,0,0,0.12);
          padding: 28px 18px 18px 18px;
          display: flex;
          flex-direction: column;
          gap: 18px;
          background: #23272f;
          color: #fff;
          z-index: 100;
          position: fixed;
          left: 0;
          top: 0;
          height: 100vh;
          width: 240px;
        }
        #sidebar-panel label[for="card-count"] {
          margin-bottom: 2px;
          font-size: 14px;
          font-weight: 500;
          display: block;
        }
        #sidebar-panel input[type="number"] {
          width: 100%;
          margin-bottom: 4px;
          border-radius: 4px;
          border: 1px solid #444;
          padding: 4px 8px;
          background: #181b20;
          color: #fff;
          outline: none;
          font-size: 15px;
          box-sizing: border-box;
        }
        #sidebar-panel .btn {
          width: 100%;
          border-radius: 4px;
          font-size: 15px;
          font-weight: 600;
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 6px;
          margin-bottom: 0;
          margin-top: 0;
          box-sizing: border-box;
          padding: 8px 0;
        }
        #sidebar-panel .btn + .btn {
          margin-top: 8px;
        }
        #sidebar-panel .section {
          display: flex;
          flex-direction: column;
          gap: 8px;
          margin-bottom: 8px;
        }
        #sidebar-panel .section + .section {
          margin-top: 8px;
        }
        #sidebar-panel .helper-text {
          font-size: 12px;
          color: #aaa;
          margin-bottom: 2px;
        }
        #sidebar-panel .divider {
          border-bottom: 1px solid #444;
          margin: 10px 0;
        }
        #sidebar-panel #lang-switch {
          margin-top: 4px;
        }
        #sidebar-panel .section-row {
          display: flex;
          flex-direction: row;
          align-items: center;
          gap: 8px;
          margin-bottom: 8px;
        }
    </style>
</head>
<body>
<div id="sidebar-panel">
  <div style="display:flex;align-items:center;justify-content:space-between;margin:0 0 18px 0;">
    <h4 style="font-size:20px;letter-spacing:1px;font-weight:700;display:flex;align-items:center;gap:8px;margin:0;">
      <span style="font-size:22px;">🃏</span> 控制面板
    </h4>
  </div>
    <div class="divider"></div>
    <div class="section">
        <div class="section-row">
            <label for="card-count" style="flex-shrink:0;">显示卡牌数量</label>
            <input id="card-count" type="number" min="1" value="9" style="flex:1;max-width:70px;min-width:40px;">
            <button id="btn-refresh" class="btn btn-primary mb-2" style="background:#23272f;border:none;border-radius:6px;padding:4px 8px;font-size:16px;font-weight:600;display:flex;align-items:center;justify-content:center;gap:0;min-width:0;min-height:0;box-shadow:none;width:auto;height:32px;">
                <span>🔄</span>
            </button>
        </div>
        <span class="helper-text">可调整显示的卡牌对数</span>
    </div>
    <div class="divider"></div>
    <div class="section">
        <div class="section-row">
            <label for="sort-field" style="flex-shrink:0;">排序方式</label>
            <select id="sort-field" style="flex:1;max-width:120px;min-width:80px;">
        <option value="description">描述</option>
        <option value="update_datetime" selected>更新时间</option>
        <option value="card_id">卡牌ID</option>
            </select>
        </div>
        <div class="section-row" style="margin-top:8px;">
            <label style="flex-shrink:0;">交替显示</label>
            <input id="alt-display-toggle" type="checkbox" style="margin-left:8px;">
            <span class="helper-text" style="margin-left:8px;">怪物与预言交替</span>
        </div>
    </div>
  <div class="divider"></div>
  <div class="section">
    <button id="btn-print" class="btn btn-success"><span>🖨️</span> 打印/导出 PDF</button>
    <div style="display:flex;align-items:center;gap:10px;justify-content:space-between;">
      <span style="font-size:14px;">语言</span>
      <div id="lang-switch" style="display:flex;align-items:center;gap:0;">
        <span id="lang-cn" style="font-size:14px;padding:2px 10px;border-radius:6px 0 0 6px;background:#3b82f6;color:#fff;cursor:pointer;transition:background 0.2s;">中文</span>
        <span id="lang-en" style="font-size:14px;padding:2px 10px;border-radius:0 6px 6px 0;background:#23272f;color:#fff;cursor:pointer;transition:background 0.2s;">English</span>
      </div>
    </div>
  </div>
  <div style="flex:1"></div>
  <div style="font-size:13px;color:#aaa;text-align:center;letter-spacing:1px;">© BoardGame 工具</div>
</div>
<div id="main-content" style="margin-left:240px;">
  <div id="card-container"></div>
</div>
<script>
    // Decode \n to real newlines
    function decodeText(s){
        return String(s??'').replace(/\\\|/g,'|').replace(/\\n/g,'\n');
    }
    let lang = 'zh'; // 'zh' or 'en'

    /* ---------- 工具 ---------- */
    // Robust pipe-splitting (copied from _editor.html)
    // Robust pipe-splitting, returns array of fields
    function parsePipeCsvLine(line) {
        const out = [];
        let cur = '';
        for (let i=0; i<line.length; i++) {
            const ch = line[i];
            if (ch === '\\') {
                const next = line[i+1];
                if (next === '|') { cur += '|'; i++; continue; }
                if (next === '\\') { cur += '\\'; i++; continue; }
                cur += '\\'; continue;
            }
            if (ch === '|') { out.push(cur); cur=''; continue; }
            cur += ch;
        }
        out.push(cur);
        return out;
    }

    // Parse CSV header line into array of field names
    function parseCsvHeader(line) {
        return parsePipeCsvLine(line);
    }

    // Map a CSV row (array) to an object using header fields
    function mapCsvRowToObj(headerArr, rowArr) {
        const obj = {};
        for (let i = 0; i < headerArr.length; i++) {
            // Always decode text fields
            obj[headerArr[i]] = rowArr[i] !== undefined ? decodeText(rowArr[i]) : '';
        }
        return obj;
    }
    // Loads CSV, returns {headerArr, rowsArr} where rowsArr is array of row arrays
    async function loadCSVWithHeader(path) {
        const txt = await (await fetch(path)).text();
        const lines = txt.split('\n').filter(r=>r.trim());
        if (lines.length === 0) return {headerArr: [], rowsArr: []};
        const headerArr = parseCsvHeader(lines[0]);
        const rowsArr = lines.slice(1).map(parsePipeCsvLine);
        return {headerArr, rowsArr};
    }
    // 修正：支持单引号 JSON
    function fixJsonQuotes(str) {
        if (!str) return str;
        if (str.trim().startsWith("'{") || str.trim().startsWith("'[") ) {
            str = str.trim().replace(/^'/, '').replace(/'$/, '');
        }
        return str.replace(/'/g, '"');
    }
    const safeParse = (str, def={}) => { try{ return JSON.parse(fixJsonQuotes(str)); } catch { return def; } };

    /* ---------- 预言卡 ---------- */
    // Robust: Accepts rowObj (field mapping) or array (legacy)
    function createProphecyCard(row, langOverride) {
        let obj;
        if (Array.isArray(row)) {
            // Legacy: fallback to old order
            const [title,intro,effect,responsive_effect='',image] = row.length===4 ? [row[0],row[1],row[2],'',row[3]] : row;
            obj = {card_title:title, introduction:intro, effect, responsive_effect, image};
        } else {
            obj = row;
        }
        const card = document.createElement('div'); card.className='card prophecy';
        if(obj.image){
            card.style.setProperty('--prophecy-bg', `url('${obj.image}')`);
        } else {
            card.style.removeProperty('--prophecy-bg');
        }
        card.innerHTML =
        `<div class="card-title"><span class="name">${obj.card_title||''}</span></div>
         <div class="card-image-container"><img src="${obj.image||''}"></div>`;
        const area = document.createElement('div'); area.className='card-content';
        // English/Chinese labels
        const l = (langOverride||lang);
        const labelEffect = l==='en' ? 'Effect' : '效果';
        const labelResponsive = l==='en' ? 'RespEkt' : '响应效果';
                function nl2br(str) { return String(str).replace(/\n/g, '<br>'); }
                if(obj.introduction){
                        area.innerHTML +=
                        `<div class="content-box attribute-box">
                             <div class="box-content">${nl2br(obj.introduction)}</div>
                         </div>`;
                }
                if(obj.effect){
                        area.innerHTML +=
                        `<div class="content-box">
                             <div class="box-title">${labelEffect}</div>
                             <div class="box-content">${nl2br(obj.effect)}</div>
                         </div>`;
                }
                if(obj.responsive_effect){
                        area.innerHTML +=
                        `<div class="content-box responsive-effect">
                             <div class="box-title">${labelResponsive}</div>
                             <div class="box-content">${nl2br(obj.responsive_effect)}</div>
                         </div>`;
                }

        shrinkToFit(area);
        card.append(area);
        // Set the background image for the pseudo-element (in case of async rendering)
        setTimeout(()=>{
            card.style.setProperty('--prophecy-bg', obj.image ? `url('${obj.image}')` : 'none');
        }, 0);
        return card;
    }

    /* ---------- 怪兽卡 ---------- */
    // Patch createMonsterCard to add 'skill-small' class if 3+ skills and lang==='en'
    // Robust: Accepts rowObj (field mapping) or array (legacy)
    function createMonsterCard(row, langOverride) {
        let obj;
        if (Array.isArray(row)) {
            // Legacy: fallback to old order
            const [title,level,type,desc,atk,def,magic,charStr,skillStr,image] = row;
            obj = {
                card_title: title, level, monster_type: type, description: desc, attack: atk, defence: def, magic,
                attributes: charStr, skills: skillStr, image
            };
        } else {
            obj = row;
        }
        const attrs = safeParse(obj.attributes, {});
        let skills = safeParse(obj.skills, []);
        if (!Array.isArray(skills)) skills = [];
        skills = skills.map(sk => ({
            name: sk.name,
            energy_cost: sk.energy_cost,
            effect: sk.effect
        }));
        const lvlIcons = '❖'.repeat(Math.max(0,parseInt(obj.level)));
        const l = (langOverride||lang);
        const labelNormal = l==='en' ? 'Attr' : '通常属性';
        const labelReact = l==='en' ? 'RespAttr' : '反应属性';
        const labelAtk = l==='en' ? 'ATK' : '攻击';
        const labelDef = l==='en' ? 'DEF' : '防御';
        const card = document.createElement('div'); card.className='card monster';
        card.innerHTML =
        `<div class="card-title">
             <span class="level">${lvlIcons}</span>
             <span class="name">${obj.card_title||''}</span>
             <span class="type">${obj.monster_type||''}</span>
         </div>
         <div class="card-image-container"><img src="${obj.image||''}"></div>`;
        const area = document.createElement('div'); area.className='card-content';
        function nl2br(str) { return String(str).replace(/\n/g, '<br>'); }
        if(obj.description){
            area.innerHTML +=
            `<div class="content-box attribute-box">
                 <div class="box-content">${nl2br(obj.description)}</div>
             </div>`;
        }
        let normalChar = attrs.normal_attribute || '';
        let reactChar = attrs.responsive_attribute || '';
        if (normalChar) {
            area.innerHTML +=
                `<div class="content-box attribute-box normal-attr">
                     <div class="box-title">${labelNormal}</div>
                     <div class="box-content">${nl2br(normalChar)}</div>
                 </div>`;
        }
        if (reactChar) {
            area.innerHTML +=
                `<div class="content-box attribute-box reaction-attr">
                     <div class="box-title">${labelReact}</div>
                     <div class="box-content">${nl2br(reactChar)}</div>
                 </div>`;
        }
        // Add skill-small class if 3+ skills and lang is en
        let skillBoxClass = (l==='en' && skills.length>=3) ? 'content-box skill-small' : 'content-box';
        if(Array.isArray(skills)){
            skills.forEach(sk=>{
                area.innerHTML +=
                `<div class="${skillBoxClass}">
                     <div class="skill-box">
                         <div>
                             <div class="skill-name">${sk.name||''}</div>
                             <div class="skill-power">${'<span class="power-icon"></span>'.repeat(sk.energy_cost||0)}</div>
                         </div>
                         <div class="skill-desc">${nl2br(sk.effect||'')}</div>
                     </div>
                 </div>`;
            });
        }
        shrinkToFit(area);
        card.append(area);
        card.innerHTML +=
        `<div class="stats">
           <div class="atk">${labelAtk}: ${obj.attack||''}</div>
           <div class="def">${labelDef}: ${obj.defence||''}</div>
         </div>`;
        return card;
    }

    /* ---------- 缩放 ---------- */
    function shrinkToFit(el){
        let fs=parseFloat(getComputedStyle(el).fontSize);
        while(el.scrollHeight>el.clientHeight && fs>5){
            fs-=0.5; el.style.fontSize=fs+'px';
        }
    }

    // --- Robust CSV loading and rendering ---
    let prophecyHeader = [], monsterHeader = [], allProphecyRows = [], allMonsterRows = [];
    let displayCount = 9;

    function getSortField() {
    const el = document.getElementById('sort-field');
    return el ? el.value : 'update_datetime';
    }
    function getAltDisplay() {
    const el = document.getElementById('alt-display-toggle');
    return el ? el.checked : true;
    }
    function sortRows(rows, header, field) {
        const idx = header.indexOf(field);
        if (idx === -1) return rows.slice();
        return rows.slice().sort((a, b) => {
            if (field === 'update_datetime') {
                // Descending: most recent last
                return (new Date(a[idx] || 0)) - (new Date(b[idx] || 0));
            } else if (field === 'card_id') {
                // Numeric sort if possible, fallback to string
                const aVal = a[idx] || '';
                const bVal = b[idx] || '';
                const aNum = parseInt(aVal, 10);
                const bNum = parseInt(bVal, 10);
                if (!isNaN(aNum) && !isNaN(bNum)) {
                    return aNum - bNum;
                }
                return aVal.localeCompare(bVal);
            } else {
                return (a[idx] || '').localeCompare(b[idx] || '');
            }
        });
    }

    async function renderAllCards() {
        const ctr = document.getElementById('card-container');
        ctr.innerHTML = '';

        // Get sort and display mode
        const sortField = getSortField();
        const altDisplay = getAltDisplay();

        // Sort independently
        const sortedProphecyRows = sortRows(allProphecyRows.slice(-displayCount), prophecyHeader, sortField);
        const sortedMonsterRows = sortRows(allMonsterRows.slice(-displayCount), monsterHeader, sortField);

        if (altDisplay) {
            // Interleave
            const maxLen = Math.max(sortedProphecyRows.length, sortedMonsterRows.length);
            for (let i = 0; i < maxLen; i++) {
                if (i < sortedMonsterRows.length) {
                    ctr.append(createMonsterCard(mapCsvRowToObj(monsterHeader, sortedMonsterRows[i])));
                }
                if (i < sortedProphecyRows.length) {
                    ctr.append(createProphecyCard(mapCsvRowToObj(prophecyHeader, sortedProphecyRows[i])));
                }
            }
        } else {
            // Grouped: monsters first, then prophecies
            for (let i = 0; i < sortedMonsterRows.length; i++) {
                ctr.append(createMonsterCard(mapCsvRowToObj(monsterHeader, sortedMonsterRows[i])));
            }
            for (let i = 0; i < sortedProphecyRows.length; i++) {
                ctr.append(createProphecyCard(mapCsvRowToObj(prophecyHeader, sortedProphecyRows[i])));
            }
        }
    }

    async function reloadCSVsAndRender() {
        let prophecy, monster;
        if(lang==='en'){
            prophecy = await loadCSVWithHeader('prophecy_cards_en.csv');
            monster = await loadCSVWithHeader('monster_cards_en.csv');
        }else{
            prophecy = await loadCSVWithHeader('prophecy_cards.csv');
            monster = await loadCSVWithHeader('monster_cards.csv');
        }
        prophecyHeader = prophecy.headerArr;
        allProphecyRows = prophecy.rowsArr;
        monsterHeader = monster.headerArr;
        allMonsterRows = monster.rowsArr;
        renderAllCards();
    }

    function setLangClass() {
        document.body.classList.toggle('en-mode', lang==='en');
    }

    /* ---------- 主入口 ---------- */
    document.addEventListener('DOMContentLoaded', () => {
    // Set alternate display as default
    document.getElementById('alt-display-toggle').checked = true;
    // Initial load
    reloadCSVsAndRender();
    setLangClass();

        // Refresh button
        document.getElementById('btn-refresh').onclick = reloadCSVsAndRender;

        // Card count input
        const cardCountInput = document.getElementById('card-count');
        cardCountInput.onchange = function() {
            let val = parseInt(cardCountInput.value, 10);
            if (isNaN(val) || val < 1) val = 1;
            displayCount = val;
            renderAllCards();
        };

        // Print button
        document.getElementById('btn-print').onclick = function() {
            // Hide sidebar for print
            document.getElementById('sidebar-panel').style.display = 'none';
            document.getElementById('main-content').style.marginLeft = '0';
            setTimeout(()=>{
                window.print();
                // Restore sidebar after print
                setTimeout(()=>{
                    document.getElementById('sidebar-panel').style.display = '';
                    document.getElementById('main-content').style.marginLeft = '240px';
                }, 100);
            }, 50);
        };

        // Language switch logic
        function updateLangSwitch() {
            document.getElementById('lang-cn').classList.toggle('active', lang === 'zh');
            document.getElementById('lang-en').classList.toggle('active', lang === 'en');
        }
        updateLangSwitch();
        document.getElementById('lang-cn').onclick = function() {
            if(lang !== 'zh') {
                lang = 'zh';
                reloadCSVsAndRender();
                setLangClass();
                updateLangSwitch();
            }
        };
        document.getElementById('lang-en').onclick = function() {
            if(lang !== 'en') {
                lang = 'en';
                reloadCSVsAndRender();
                setLangClass();
                updateLangSwitch();
            }
        };
    });

</script>
</body>
</html>
